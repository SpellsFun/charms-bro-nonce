# GPU 优化指南

## RTX 5090 特定优化

### 1. 增加并行度
```bash
# 4090 配置
threads_per_block: 512
blocks: 4096

# 5090 建议配置
threads_per_block: 768-1024  # 更多线程
blocks: 8192-16384           # 更多块
```

### 2. ILP 优化
```bash
# 5090 有更多寄存器，可以增加 ILP
ilp: 8  # 从 4 提升到 8
```

### 3. 占用率优化
- 5090 每个 SM 可以运行更多 warp
- 调整 chunk_size 以更好利用缓存

### 4. 功耗效率模式
```json
{
  "options": {
    "blocks": 12288,           // 75% 利用率
    "threads_per_block": 768,  // 平衡功耗
    "ilp": 6                   // 适中的 ILP
  }
}
```

## 性能对比测试

### 测试命令
```bash
# 4090 基准测试
curl -X POST http://localhost:8001/api/v1/jobs \
  -d '{"outpoint":"test","options":{"total_nonce":10000000000}}'

# 记录: rate_ghs 值
```

## 硬件监控
```bash
# 监控 GPU 利用率和功耗
nvidia-smi dmon -s pucvmet -i 0
```

## 预期收益

| GPU | 算力 (GH/s) | 功耗 (W) | 效率 (MH/J) |
|-----|------------|----------|-------------|
| 4090 | 7.5 | 450 | 16.7 |
| 5090 (预估) | 12-14 | 550 | 21-25 |

## 成本效益分析

```python
# 24小时运行成本（电费 0.1$/kWh）
4090: 450W * 24h * 0.1 / 1000 = $1.08/天
5090: 550W * 24h * 0.1 / 1000 = $1.32/天

# 性能提升
性能比: 1.6-1.8x
成本比: 1.22x
效益提升: 31-47%
```